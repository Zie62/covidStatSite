Rewrite backend to reduce re-used code. 
Stylization